'use strict';

angular.module('mean.pages').factory('iocIcon', [
	function() {
		var iocIcon = function(severity) {
			switch(severity){
				case 1:
					return 'fa-flag';
				case 2:
					return 'fa-bullhorn';
				case 3:
					return 'fa-bell';
				case 4:
					return 'fa-exclamation-circle';
				default:
					return 'fa-question';
			}
		};
		return iocIcon;
	}
]);

// angular.module('mean.pages').factory('appIcon', [
// 	function() {
// 		var appIcon = function(app) {
// 			var app = app.toLowerCase();
// 			switch(app) {
// 				case 'http':
// 					return '<svg version="1.1" id="Layer_1" x="0px" y="0px" width="42.794px" height="42.795px" viewBox="0 0 42.794 42.795" enable-background="new 0 0 42.794 42.795" xml:space="preserve"> <g> <g> <defs> <circle id="SVGID_1_" cx="21.397" cy="21.398" r="21.397"/> </defs> <use xlink:href="#SVGID_1_"  overflow="visible" fill="#BBBDBF"/> <clipPath id="SVGID_2_"> <use xlink:href="#SVGID_1_"  overflow="visible"/> </clipPath> </g> <g> <g> <path fill-rule="evenodd" clip-rule="evenodd" fill="#F3BD5D" d="M16.223,4.356h-4c-0.333,0-0.607,0.278-0.607,0.617v4.056 c0,0.339,0.274,0.615,0.607,0.615h4c0.335,0,0.609-0.276,0.609-0.615V4.974C16.832,4.635,16.558,4.356,16.223,4.356z M23.398,4.356h-4.001c-0.334,0-0.607,0.278-0.607,0.617v4.056c0,0.339,0.273,0.615,0.607,0.615h4.001 c0.334,0,0.607-0.276,0.607-0.615V4.974C24.005,4.635,23.732,4.356,23.398,4.356z M30.572,4.356h-4 c-0.336,0-0.609,0.278-0.609,0.617v4.056c0,0.339,0.273,0.615,0.609,0.615h4c0.334,0,0.607-0.276,0.607-0.615V4.974 C31.179,4.635,30.906,4.356,30.572,4.356z M16.223,33.629h-4c-0.333,0-0.607,0.277-0.607,0.617v4.053 c0,0.34,0.274,0.618,0.607,0.618h4c0.335,0,0.609-0.278,0.609-0.618v-4.053C16.832,33.906,16.558,33.629,16.223,33.629z M23.398,33.629h-4.001c-0.334,0-0.607,0.277-0.607,0.617v4.053c0,0.34,0.273,0.618,0.607,0.618h4.001 c0.334,0,0.607-0.278,0.607-0.618v-4.053C24.005,33.906,23.732,33.629,23.398,33.629z M30.572,33.629h-4 c-0.336,0-0.609,0.277-0.609,0.617v4.053c0,0.34,0.273,0.618,0.609,0.618h4c0.334,0,0.607-0.278,0.607-0.618v-4.053 C31.179,33.906,30.906,33.629,30.572,33.629z"/> </g> </g> <text transform="matrix(1 0 0 1 7.4443 26.3291)" fill="#939393" font-family="ITCAvantGardeStd-Bk" font-size="14">http</text> </g> </svg>';
// 			}
// 		}
// 		return appIcon;
// 	}
// ]);
// 

angular.module('mean.pages').factory('appIcon', [
	function() {
		var appIcon = function(app) {
			// make input lowercase
			var app = app.toLowerCase();
			// create an empty div
			var div = $('<div></div>');
			// split app into array
			// var match = app.match(/(\w+)\/(.*)/);
			// append base svg
			var elm = d3.select(div[0])
				.append('svg')
				.attr('x',0)
				.attr('y',0)
				.attr('width','42.795px')
				.attr('height','42.795px')
				.attr('viewBox','0 0 42.795 42.795')
				.attr('enable-background','new 0 0 42.795 42.795')
				.attr('xml:space','preserve');
			var tip = d3.tip()
				.attr('class', 't-tip')
				.offset([-30, 0])
				.html(function(d) {
					return app;
				});
			elm.call(tip);
			elm
				.on('mouseover', tip.show)
				.on('mouseout', tip.hide);

			var em = elm.append('g');
			var bg = em.append('circle').attr('cx', 21.398).attr('cy', 21.398).attr('r', 21.398);

			if (!app) return appIcon;
			// background color generated here
			bg.style('fill', '#dddddd');
			em
				.append('path')
				.style('fill', '#c2c2c2')
				.attr('d', 'M21.378,42.795c10.232,0,18.773-7.187,20.884-16.785h-0.793v-1.613h-1.748v5.251h-1.746v-2.003h-1.748v4.3'+
				'h-1.746v1.411h-1.748v-1.411h-1.746v4.371h-1.748v-1.589h-1.746v-4.411h-1.748v1.7h-1.746v-3.997h-1.748v2.749h-1.747v3.613h-1.747'+
				'v1.297H17.01v4.612h-1.747V37.04h-1.747v-3.996h-1.747v-1.301h-1.747v4.781H8.274v-2.702H6.527v-3.388H4.78v-3.489H3.033v1.411'+
				'H1.286V28.7C4.274,36.917,12.129,42.795,21.378,42.795z');
			// switch between text
			switch(app) {
				case 'http':
					em
						.append('text')
						.attr('transform', 'matrix(1 0 0 1 6.5 22)')
						.style('fill', '#f2bc5d')
						.attr('font-family', 'ITCAvantGardeStd-Bk')
						.attr('font-size', 14)
						.text('html');
					return div;
				case 'ssl':
					em
						.append('text')
						.attr('transform', 'matrix(1 0 0 1 11 20)')
						.style('fill', '#D97373')
						.attr('font-family', 'ITCAvantGardeStd-Bk')
						.attr('font-size', 14)
						.text('SSL');
					return div;
				case 'unknown':
					em
						.append('text')
						.attr('transform', 'matrix(1 0 0 1 16 22)')
						.style('fill', '#D8464A')
						.attr('font-family', 'ITCAvantGardeStd-Bk')
						.attr('font-size', 20)
						.text('?');
					return div;
				case 'google':
					em
						.append('path')
						.style('fill', '#0C75BC')
						.attr('d', 'M10.785,22.308l-1.771,0.409c-0.719,0.111-1.363,0.21-2.045,0.21'+
						'c-3.42,0-4.721-2.515-4.721-4.485c0-2.403,1.847-4.634,5.006-4.634c0.67,0,1.314,0.1,1.896,0.261'+
						'c0.929,0.26,1.363,0.582,1.635,0.769l-1.028,0.979l-0.433,0.099l0.309-0.495c-0.421-0.409-1.189-1.164-2.65-1.164'+
						'c-1.959,0-3.434,1.486-3.434,3.654c0,2.329,1.686,4.522,4.387,4.522c0.793,0,1.202-0.161,1.574-0.31v-1.995l-1.871,0.099'+
						'l0.99-0.532h2.627l-0.321,0.311c-0.087,0.073-0.1,0.099-0.124,0.197c-0.013,0.111-0.025,0.471-0.025,0.595V22.308L10.785,22.308z');
					em
						.append('path')
						.style('fill', '#EF4035')
						.attr('d', 'M14.851,22.769c-2.102,0-3.226-1.639-3.226-3.119'+
						'c0-1.73,1.415-3.211,3.424-3.211c1.942,0,3.158,1.52,3.158,3.119C18.207,21.116,17.005,22.769,14.851,22.769L14.851,22.769z'+
						'M16.502,21.698c0.318-0.423,0.396-0.951,0.396-1.467c0-1.163-0.555-3.383-2.193-3.383c-0.436,0-0.872,0.172-1.189,0.449'+
						'C13,17.76,12.908,18.341,12.908,18.91c0,1.308,0.646,3.462,2.246,3.462C15.67,22.372,16.199,22.121,16.502,21.698L16.502,21.698z');
					em
						.append('path')
						.style('fill', '#F9A600')
						.attr('d', 'M21.881,22.769c-2.101,0-3.225-1.639-3.225-3.119'+
						'c0-1.73,1.415-3.211,3.424-3.211c1.943,0,3.158,1.52,3.158,3.119C25.239,21.116,24.036,22.769,21.881,22.769L21.881,22.769z'+
						' M23.534,21.698c0.316-0.423,0.396-0.951,0.396-1.467c0-1.163-0.555-3.383-2.193-3.383c-0.436,0-0.874,0.172-1.19,0.449'+
						'c-0.516,0.462-0.607,1.043-0.607,1.612c0,1.308,0.646,3.462,2.247,3.462C22.702,22.372,23.229,22.121,23.534,21.698L23.534,21.698z');
					em
						.append('path')
						.style('fill', '#0C75BC')
						.attr('d', 'M30.077,17.086c0.303,0.251,0.937,0.779,0.937,1.784'+
						'c0,0.979-0.554,1.44-1.108,1.877c-0.172,0.171-0.371,0.357-0.371,0.647c0,0.291,0.199,0.449,0.344,0.568l0.477,0.37'+
						'c0.581,0.488,1.108,0.938,1.108,1.85c0,1.243-1.202,2.498-3.476,2.498c-1.916,0-2.84-0.912-2.84-1.89'+
						'c0-0.477,0.236-1.149,1.018-1.613c0.818-0.501,1.93-0.567,2.523-0.607c-0.186-0.237-0.396-0.488-0.396-0.898'+
						'c0-0.225,0.066-0.356,0.133-0.516c-0.146,0.014-0.291,0.027-0.424,0.027c-1.4,0-2.193-1.045-2.193-2.075'+
						'c0-0.608,0.277-1.282,0.846-1.771c0.754-0.621,1.652-0.727,2.365-0.727h2.722l-0.846,0.476H30.077L30.077,17.086z M29.137,22.954'+
						'c-0.105-0.014-0.172-0.014-0.303-0.014c-0.119,0-0.834,0.026-1.389,0.211c-0.291,0.106-1.137,0.424-1.137,1.362'+
						's0.912,1.612,2.326,1.612c1.27,0,1.942-0.608,1.942-1.428C30.578,24.024,30.143,23.667,29.137,22.954L29.137,22.954z'+
						' M29.522,20.443c0.303-0.305,0.33-0.728,0.33-0.966c0-0.951-0.568-2.432-1.666-2.432c-0.344,0-0.713,0.172-0.926,0.437'+
						'c-0.225,0.277-0.291,0.635-0.291,0.979c0,0.885,0.516,2.352,1.652,2.352C28.952,20.812,29.309,20.654,29.522,20.443L29.522,20.443z');
					em
						.append('path')
						.style('fill', '#2FB357')
						.attr('d', 'M34.41,22.597h-2.338c0.303-0.396,0.355-0.436,0.355-0.699v-2.155'+
						'c0-1.03,0.014-2.498,0.053-3.872c0.014-0.674,0.066-1.52,0.08-2.128h-1.031l0.992-0.476h1.889'+
						'c-0.408,0.238-0.541,0.317-0.594,0.779c-0.105,1.018-0.119,2.63-0.119,4.507v3.053c0,0.516,0.092,0.596,0.529,0.635'+
						'c0.225,0.026,0.449,0.04,0.674,0.066L34.41,22.597L34.41,22.597z');
					em
						.append('path')
						.style('fill', '#EF4035')
						.attr('d', 'M39.552,22.307c-0.146,0.079-0.291,0.171-0.438,0.238'+
						'c-0.436,0.197-0.885,0.25-1.281,0.25c-0.424,0-1.084-0.026-1.758-0.515c-0.938-0.661-1.348-1.798-1.348-2.789'+
						'c0-2.049,1.664-3.053,3.025-3.053c0.477,0,0.965,0.119,1.361,0.37c0.662,0.436,0.834,1.004,0.926,1.309l-3.105,1.255l-1.018,0.079'+
						'c0.33,1.679,1.467,2.657,2.723,2.657c0.674,0,1.162-0.238,1.611-0.463L39.552,22.307L39.552,22.307z M38.31,18.368'+
						'c0.25-0.093,0.383-0.172,0.383-0.357c0-0.528-0.596-1.137-1.309-1.137c-0.529,0-1.52,0.41-1.52,1.838'+
						'c0,0.224,0.025,0.462,0.039,0.7L38.31,18.368L38.31,18.368z');
					return div;
				case 'bittorrent':
					em
						.append('text')
						.attr('transform', 'matrix(1 0 0 1 8 20)')
						.style('fill', '#F68D55')
						.attr('font-family', 'ITCAvantGardeStd-Bk')
						.attr('font-size', 13)
						.text('BiTor');
					return div;
				case 'apple':
					em
						.append('path')
						.style('fill', '#727272')
						.attr('d', 'M28.5,13.481c-0.915-1.139-2.196-1.798-3.407-1.798'+
						'c-1.602,0-2.278,0.76-3.389,0.76c-1.145,0-2.016-0.759-3.401-0.759c-1.36,0-2.807,0.826-3.724,2.238'+
						'c-1.291,1.987-1.072,5.725,1.021,8.909c0.748,1.139,1.748,2.419,3.055,2.431c1.162,0.011,1.49-0.741,3.066-0.749'+
						'c1.576-0.01,1.874,0.758,3.035,0.747c1.308-0.013,2.361-1.431,3.11-2.57c0.536-0.815,0.735-1.228,1.151-2.15'+
						'C25.992,19.397,25.505,15.122,28.5,13.481z');
					em
						.append('path')
						.style('fill', '#727272')
						.attr('d', 'M23.878,10.41c0.582-0.747,1.023-1.801,0.863-2.878'+
						'c-0.951,0.065-2.062,0.67-2.711,1.458c-0.589,0.715-1.075,1.776-0.886,2.808C22.182,11.83,23.255,11.21,23.878,10.41z');
					return div;
				case 'facebook':
					em
						.append('path')
						.style('fill', '#3C5A98')
						.attr('d', 'M30.697,24.701V8.094c0-0.469-0.379-0.85-0.848-0.85h-1.514H14.459h-1.514'+
						'c-0.467,0-0.846,0.379-0.848,0.846v15.098v1.516c0,0.467,0.38,0.848,0.848,0.848h9.388v-7.35H19.91v-2.533h2.423v-2.75'+
						'c0-1.646,1.494-2.754,2.699-2.754h2.713v2.305h-1.251c-0.617,0-1.439,0.5-1.439,1.115v2.084H27.5v2.533h-2.445v7.35h3.281h1.514'+
						'C30.318,25.551,30.697,25.17,30.697,24.701z');
					return div;
				case 'dns':
					em
						.append('text')
						.attr('transform', 'matrix(1 0 0 1 7 22)')
						.style('fill', '#A0BB71')
						.attr('font-family', 'ITCAvantGardeStd-Bk')
						.attr('font-size', 14)
						.text('DNS');
					return div;
			}
		}
		return appIcon;
	}
]);

angular.module('mean.pages').factory('mimeIcon', [
	function() {
		var mimeIcon = function(mime) {
			// only run if mime contains a / (otherwise it'll break trying to match nothing)
			if (mime.search('/') === -1) return;
			// make input lowercase
			var mime = mime.toLowerCase();
			// create an empty div
			var div = $('<div></div>');
			// split mime into array
			var match = mime.match(/(\w+)\/(.*)/);
			// append base svg
			var elm = d3.select(div[0])
				.append('svg')
				.attr('x',0)
				.attr('y',0)
				.attr('width','42.795px')
				.attr('height','42.795px')
				.attr('viewBox','0 0 42.795 42.795')
				.attr('enable-background','new 0 0 42.795 42.795')
				.attr('xml:space','preserve');

			var tip = d3.tip()
				.attr('class', 't-tip')
				.offset([-30, 0])
				.html(function(d) {
					return mime;
				});
			elm.call(tip);
			elm
				.on('mouseover', tip.show)
				.on('mouseout', tip.hide);

			var em = elm.append('g');
			var bg = em.append('circle').attr('cx', 21.398).attr('cy', 21.398).attr('r', 21.398);

			if (!match) return mimeIcon;
			if (match[1] == 'application') {
				// background color generated here
				bg.style('fill', '#989898');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('d', 'M18.515,6.498h5.769c0.482,0,0.876-0.401,0.876-0.89V0.351C23.936,0.133,22.684,0,21.398,0'+
					'c-1.286,0-2.539,0.133-3.762,0.351v5.258C17.637,6.097,18.033,6.498,18.515,6.498z'+
					'M27.857,15.981h5.767c0.481,0,0.876-0.401,0.876-0.892V9.245c0-0.487-0.395-0.888-0.876-0.888h-5.767'+
					'c-0.484,0-0.877,0.401-0.877,0.888v5.844C26.98,15.58,27.373,15.981,27.857,15.981z'+
					'M9.172,6.498h5.768c0.483,0,0.879-0.401,0.879-0.89V0.761c-2.772,0.748-5.318,2.032-7.523,3.745v1.103'+
					'C8.295,6.097,8.691,6.498,9.172,6.498z'+
					'M9.172,15.981h5.768c0.483,0,0.879-0.401,0.879-0.892V9.245c0-0.487-0.396-0.888-0.879-0.888H9.172'+
					'c-0.48,0-0.876,0.401-0.876,0.888v5.844C8.295,15.58,8.691,15.981,9.172,15.981z'+
					'M26.98,0.761v4.847c0,0.489,0.393,0.89,0.877,0.89h5.767c0.481,0,0.876-0.401,0.876-0.89V4.506'+
					'C32.296,2.793,29.751,1.509,26.98,0.761z'+
					'M25.159,15.089V9.245c0-0.487-0.394-0.888-0.876-0.888h-5.769c-0.481,0-0.878,0.401-0.878,0.888v5.844'+
					'c0,0.49,0.396,0.892,0.878,0.892h5.769C24.766,15.981,25.159,15.58,25.159,15.089z');
				// switch between text
				switch(match[2]) {
					case 'x-bzip2':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9.2139 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('BZ2');
						return div;
					case 'octet-stream':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9 29)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 8)
							.text('01001');
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9 37)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 8)
							.text('10011');
						return div;
					case 'xml':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 13)
							.text('XML');
						return div;
					case 'x-gzip':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 10 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 15)
							.text('GZ');
						return div;
					case 'x-shockwave-flash':
						em
							.append('path')
							.style('fill', '#c3c3c3')
							.attr('d', 'M28.614,21.494l-0.121,3.552c0,0-4.175,0.83-4.295,3.904h2.383l0.125,3.551l-4.178-0.117'+
								'c0,0-1.792,7.338-8.477,7.221l-0.119-3.312c0,0,3.581,0.234,5.492-6.158C19.425,30.134,21.449,21.615,28.614,21.494z');
						return div;
					case 'pdf':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9.4 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('PDF');
						return div;
					case 'rpm':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 5.2 31.6)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('x-rpm');
						return div;
					case 'pgp-signature':
						em
							.append('path')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd') 
							.style('fill', '#c3c3c3')
							.attr('d', 'M26.946,29.114V27.06l0,0c0-0.002,0-0.004,0-0.007'+
								'c0-3.123-2.514-5.655-5.617-5.655c-3.102,0-5.615,2.532-5.615,5.655c0,0.003,0,0.005,0,0.007v2.055h-1.15v9.037h13.574v-9.037'+
								'H26.946z M24.966,27.262v1.853h-7.174v-1.853c0-0.003,0-0.005,0-0.007c0-1.994,1.121-3.817,3.559-3.817'+
								'c2.389,0,3.615,1.823,3.615,3.817C24.966,27.257,24.966,27.259,24.966,27.262z');
						em
							.append('path')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd') 
							.style('fill', '#c3c3c3')
							.attr('d', 'M40.007,18.596l-0.76-2.507l-2.023-1.661l-2.605-0.257l-2.31,1.234'+
								'l-1.234,2.311l0.21,2.897l1.773,1.253l-1.381,7.327l1.922,2.132l1.729-8.689l2.096,8.806l1.93-2.054l-1.364-7.604l1.259-0.682'+
								'L40.007,18.596z');
						return div;
					case 'postscript':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8.95 34.57)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 15)
							.text('P.S.');
						return div;
					case 'ttf':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 10.6 35.39)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 15)
							.text('TTF');
						return div;
					case 'x-dosexec':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8.8 34.54)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('>_');
						em
							.append('path')
							.style('fill', '#c3c3c3')
							.attr('d', 'M32.643,27.167l1.274-1.784l-1.396-1.396l-1.784,1.274l-1.058-0.438l-0.36-2.162h-1.975l-0.36,2.162'+
								'l-1.059,0.438l-1.783-1.274l-1.396,1.396l1.274,1.784l-0.438,1.058l-2.162,0.36v1.975l2.162,0.36l0.438,1.058l-1.274,1.784'+
								'l1.396,1.396l1.783-1.274l1.059,0.438l0.36,2.162h1.975l0.36-2.162l1.058-0.438l1.784,1.274l1.396-1.396l-1.274-1.784l0.438-1.058'+
								'l2.162-0.36v-1.975l-2.162-0.36L32.643,27.167L32.643,27.167z M28.331,31.547l-1.975-1.975l1.975-1.975l1.975,1.975L28.331,31.547'+
								'L28.331,31.547z');
						return div;
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8.79 34.54)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('>_');
						return div;
					case 'x-elc':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 10 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 15)
							.text('elc');
						return div;
					case 'ogg':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6 31)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('ogg');
						return div;
					case 'zip':
						em
							.append('polygon')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd') 
							.style('fill', '#c3c3c3')
							.attr('points', '29.796,38.05 29.796,37.1 26.946,37.1 25.996,36.15 '+
								'25.996,34.25 27.896,34.25 27.896,31.4 25.996,31.4 25.996,26.275 27.896,26.275 27.896,23.9 25.521,23.9 22.671,22 16.021,22 '+
								'14.121,23.9 21.721,23.9 24.096,26.275 24.096,31.4 21.721,33.775 14.121,33.775 15.546,35.675 22.196,35.675 24.096,34.25 '+
								'24.096,36.15 23.146,37.1 20.296,37.1 20.296,38.05 23.146,38.05 24.096,39 25.996,39 26.946,38.05');
						em
							.append('polygon')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd') 
							.style('fill', '#c3c3c3')
							.attr('points', '20.296,32.825 21.721,31.4 21.721,24.85 13.171,24.85 11.746,26.275 11.746,32.825 ');
						return div;
					case 'x-bittorrent':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 7 32)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('BiTor');
						return div;
				}
			}
			if (match[1] == 'text') {
				// background color generated here
				bg.style('fill', '#989898');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('d', 'M9.228,16.602h3.212V6.845h2.465V4.023H9.053C8.24,4.608,7.468,5.244,6.746,5.934v0.911h2.482V16.602z');
				em
					.append('polygon')
					.style('fill', '#c3c3c3')
					.attr('points', '27.774,16.602 23.422,9.973 27.263,4.023 23.643,4.023 21.552,7.61 19.394,4.023 15.756,4.023 '+ 
					'19.648,9.905 15.246,16.602 18.833,16.602 21.417,12.148 24.136,16.602 ');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('d', 'M33.969,4.023h-5.837v2.822h2.481v9.757h3.212V6.845h2.465V5.948C35.564,5.252,34.788,4.611,33.969,4.023z');
				// switch between text
				switch(match[2]) {
					case 'plain':
						return div;
					case 'pgp':
						em
							.append('path')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd') 
							.style('fill', '#c3c3c3')
							.attr('d', 'M27.17,29.272v-2.055l0,0c0-0.003,0-0.005,0-0.007'+
								'c0-3.123-2.514-5.655-5.617-5.655c-3.102,0-5.615,2.532-5.615,5.655c0,0.002,0,0.004,0,0.007v2.055h-1.15v9.036h13.574v-9.036H27.17'+
								'z M25.189,27.42v1.853h-7.174V27.42c0-0.003,0-0.005,0-0.008c0-1.994,1.121-3.816,3.559-3.816c2.389,0,3.615,1.822,3.615,3.816'+
								'C25.189,27.415,25.189,27.417,25.189,27.42z');
						return div;
					case 'html':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9.3936 34.5557)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('</>');
						return div;
					case 'x-shellscript':
						em
							.append('path')
							.attr('fill-rule', 'evenodd')
							.attr('clip-rule', 'evenodd')
							.style('fill', '#c3c3c3')
							.attr('d', 'M31.665,28.999l-3.078,2.764l2.616-3.812l-1.848-3.234l-3,4.674'+
								'l2.261-5.285l-2.771-2.01l-1.979,6.074l0.871-6.336l-3.325-0.612l-0.277,6.502l-0.462-6.415l-3.416,0.699l1.043,6.115l-1.874-5.854'+
								'l-2.957,2.186l2.013,4.537l-2.659-4.1l-1.661,3.496l2.982,3.938l-3.445-2.978l-0.461,2.797l5.265,3.408v2.973l5.877,0.861'+
								'l5.574-1.037l0.093-2.797l4.987-3.496L31.665,28.999z M21.218,32.666l-4.573,1.927v-1.576l3.061-1.053l-3.061-1.035v-1.576'+
								'l4.573,1.928V32.666z M26.042,35.376h-4.501v-0.45h4.501V35.376z');
						return div;
					case 'x-c++':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6.9932 33.5557)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('C++');
						return div;
					case 'fortran':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8.0713 34.5557)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('Fortran');
						return div;
					case 'x-asm':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 7.3218 32.9746)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('asm');
						return div;					
					case 'troff':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 7.8828 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('troff');
					return div;
					case 'x-pascal':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8.8 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 14)
							.text('Pas');
					return div;
				}
			}
			if (match[1] == 'image') {
				// background color generated here
				bg.style('fill', '#989898');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('d', 'M42.078,15.98C39.676,6.792,31.342,0,21.398,0C10.924,0,2.221,7.534,0.376,17.474l11.757-7.152l9.506,5.928'+
					'l-2.232-2.265l9.326-6.869L42.078,15.98z'+
					'M16.02,8.862c-1.439,0-2.605-1.167-2.605-2.605s1.166-2.604,2.605-2.604'+
					'c1.438,0,2.604,1.165,2.604,2.604S17.458,8.862,16.02,8.862z')
				// switch between text
				switch(match[2]) {
					case 'jpeg':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6.5 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 13)
							.text('JPEG');
						return div;
					case 'png':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 8 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 13)
							.text('PNG');
						return div;
					case 'gif':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 11 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 13)
							.text('GIF');
						return div;
					case 'x-icon':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6 31)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('X-ICO');
						return div;
					case 'svg+xml':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6 30)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('S+xml');
						return div;
				}
			}
			if (match[1] == 'audio') {
				// background color generated here
				bg.style('fill', '#989898');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('fill-rule', 'evenodd')
					.attr('clip-rule', 'evenodd')
					.attr('d', 'M37.457,7.287c-0.062,1.312-0.03,2.372-0.443,0.528'+
					'c-0.537-2.393-0.858-1.329-1.073,1.118c-0.213,2.446-0.322,1.808-0.697,0c-0.375-1.809-0.215-1.118-0.643,0.16'+
					'c-0.43,1.275-0.484,3.882-0.807,2.499c-0.32-1.383-0.482,1.276-1.234-1.17c-0.75-2.447-0.482,1.648-1.18-2.553'+
					'c-0.697-4.204-0.643-1.703-1.18,0.158C29.663,9.892,29.556,9.2,29.341,7.87s-0.59-1.011-0.805,0.105'+
					'c-0.215,1.118-0.162,4.788-0.322,3.777c-0.16-1.012-0.482-1.33-0.645-0.054c-0.16,1.276-0.16-1.063-0.215-2.074'+
					'c-0.053-1.011-0.375-0.904-0.428,0c-0.055,0.904-0.484,2.926-0.592,2.233c-0.107-0.691-0.479-0.095-0.547,0.112l-0.002-0.006'+
					'c0,0,0.127-1.097-0.381-0.386c-0.117-0.617-0.291-1.061-0.465-0.412c-0.215,0.798-0.643,0.105-0.752-0.638'+
					'c-0.105-0.746-0.588-0.852-0.697-1.649C23.39,8.128,22.89,8.613,22.46,9.039c-0.482,0.479-1.127,2.926-1.502-0.585'+
					'c-0.377-3.511-0.752-2.499-1.234-1.223c-0.484,1.275-0.537,2.552-0.967-1.437s-0.805-1.542-0.857-0.106'+
					'c-0.055,1.437,0.32,7.555-0.592-0.585c-0.912-8.138-0.857-0.585-1.072,1.011s0,4.096-0.537,1.701'+
					'c-0.537-2.393-0.859-1.329-1.074,1.118c-0.213,2.446-0.32,1.808-0.697,0c-0.375-1.809-0.215-1.118-0.643,0.16'+
					'c-0.43,1.275-0.484,3.882-0.807,2.499c-0.32-1.383-0.482,1.276-1.232-1.17c-0.752-2.447-0.482,1.648-1.182-2.553'+
					'c-0.697-4.204-0.643-1.703-1.18,0.158C8.347,9.892,8.238,9.2,8.023,7.87s-0.59-1.011-0.805,0.105'+
					'c-0.213,1.118-0.162,4.788-0.322,3.777c-0.16-1.012-0.482-1.33-0.645-0.054c-0.16,1.276-0.16-1.063-0.215-2.074'+
					'c-0.053-1.011-0.375-0.904-0.428,0c-0.055,0.904-0.484,2.926-0.59,2.233c-0.109-0.691-0.27-1.011-0.377-0.531'+
					'c-0.105,0.479-0.375,1.489-0.482,0.692c-0.107-0.799-0.322-1.65-0.537-0.853c-0.2,0.745-0.584,0.188-0.722-0.494'+
					'c-0.632,1.088-1.165,2.236-1.6,3.435c0.126,0.575,0.266,1.292,0.39,2.117c0.23,1.534,0.375,1.012,0.482,0.213'+
					'c0.107-0.798,0.592-0.904,0.699-1.65c0.107-0.745,0.535-1.438,0.75-0.639s0.43-0.054,0.537-0.853s0.377,0.213,0.482,0.691'+
					'c0.107,0.48,0.268,0.161,0.377-0.532c0.105-0.691,0.535,1.332,0.59,2.236c0.053,0.906,0.375,1.013,0.428,0'+
					'c0.055-1.012,0.055-3.354,0.215-2.075c0.162,1.277,0.484,0.958,0.645-0.054s0.109,2.662,0.322,3.782'+
					'c0.215,1.117,0.59,1.436,0.805,0.104s0.323-2.023,0.86-0.159s0.482,4.368,1.18,0.159c0.699-4.206,0.43-0.104,1.182-2.556'+
					'c0.75-2.45,0.912,0.214,1.232-1.172c0.322-1.385,0.377,1.226,0.807,2.503c0.428,1.277,0.268,1.97,0.643,0.16'+
					'c0.377-1.811,0.484-2.45,0.697,0c0.215,2.45,0.537,3.516,1.074,1.117c0.537-2.395,0.322,0.108,0.537,1.705'+
					'c0.215,1.598,0.16,9.159,1.072,1.012s0.537-2.024,0.592-0.585c0.053,1.437,0.428,3.888,0.857-0.107'+
					'c0.43-3.993,0.482-2.716,0.967-1.438c0.482,1.278,0.857,2.29,1.234-1.225c0.375-3.515,1.02-1.064,1.502-0.586'+
					'c0.43,0.427,0.93,0.912,1.031,0.159c0.109-0.798,0.592-0.904,0.697-1.65c0.109-0.745,0.537-1.438,0.752-0.639'+
					'c0.174,0.648,0.348,0.204,0.465-0.413c0.508,0.711,0.381-0.386,0.381-0.386l0.002-0.005c0.068,0.206,0.439,0.804,0.547,0.11'+
					'c0.107-0.691,0.537,1.332,0.592,2.236c0.053,0.906,0.375,1.013,0.428,0c0.055-1.012,0.055-3.354,0.215-2.075'+
					'c0.162,1.277,0.484,0.958,0.645-0.054s0.107,2.662,0.322,3.782c0.215,1.117,0.59,1.436,0.805,0.104s0.322-2.023,0.859-0.159'+
					's0.482,4.368,1.18,0.159c0.697-4.206,0.43-0.104,1.18-2.556c0.752-2.45,0.914,0.214,1.234-1.172'+
					'c0.322-1.385,0.377,1.226,0.807,2.503c0.428,1.277,0.268,1.97,0.643,0.16c0.375-1.811,0.484-2.45,0.697,0'+
					'c0.215,2.45,0.536,3.516,1.073,1.117c0.537-2.395,0.322,0.108,0.537,1.705c0.213,1.598,0.16,9.159,1.072,1.012'+
					's0.537-2.024,0.592-0.585c0.053,1.437,0.428,3.888,0.857-0.107c0.43-3.993,0.482-2.716,0.967-1.438'+
					'c0.48,1.278,0.857,2.29,1.234-1.225c0.003-0.031,0.007-0.054,0.011-0.084C41.493,13.191,39.8,9.951,37.457,7.287zw')
				// switch between text
				switch(match[2]) {
					case 'mpeg':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 6 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 11)
							.text('MPEG');
						return div;
					case 'mp4':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 9 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('mp4');
						return div;
				}
			}
			if (match[1] == 'video') {
				// background color generated here
				bg.style('fill', '#989898');
				em
					.append('path')
					.style('fill', '#c3c3c3')
					.attr('fill-rule', 'evenodd')
					.attr('clip-rule', 'evenodd')
					.attr('d', 'M16.346,16.707c0,0.229,0.182,0.414,0.412,0.414h1.122c0.226,0,0.412-0.185,0.412-0.414v-1.95'+
					'c0-0.229-0.187-0.415-0.412-0.415h-1.122c-0.23,0-0.412,0.186-0.412,0.415V16.707z'+
					'M12.152,14.342c-0.228,0-0.416,0.186-0.416,0.415v1.95c0,0.229,0.188,0.414,0.416,0.414h1.122'+
					'c0.23,0,0.412-0.185,0.412-0.414v-1.95c0-0.229-0.182-0.415-0.412-0.415H12.152z'+
					'M7.549,17.121h1.116c0.23,0,0.418-0.185,0.418-0.414v-1.95c0-0.229-0.188-0.415-0.418-0.415H7.549'+
					'c-0.229,0-0.417,0.186-0.417,0.415v1.95C7.132,16.937,7.32,17.121,7.549,17.121z'+
					'M14.329,1.221C8.886,3.128,4.458,7.165,2.032,12.341h12.297V1.221z'+
					'M36.919,16.707v-1.95c0-0.229-0.19-0.415-0.418-0.415h-1.116c-0.229,0-0.419,0.186-0.419,0.415v1.95'+
					'c0,0.228,0.189,0.414,0.419,0.414h1.116C36.729,17.121,36.919,16.935,36.919,16.707z'+
					'M21.399,0c-1.434,0-2.833,0.147-4.188,0.416v11.925h23.554C37.353,5.057,29.976,0,21.399,0z'+
					'M41.108,14.342h-1.121c-0.228,0-0.416,0.186-0.416,0.415v1.95c0,0.228,0.188,0.414,0.416,0.414h1.121'+
					'c0.229,0,0.412-0.187,0.412-0.414v-1.95C41.521,14.527,41.338,14.342,41.108,14.342z'+
					'M27.168,17.121c0.228,0,0.415-0.187,0.415-0.414v-1.95c0-0.229-0.188-0.415-0.415-0.415h-1.123'+
					'c-0.226,0-0.412,0.186-0.412,0.415v1.95c0,0.228,0.187,0.414,0.412,0.414H27.168z'+
					'M22.896,16.707v-1.95c0-0.229-0.185-0.415-0.418-0.415h-1.119c-0.227,0-0.416,0.186-0.416,0.415v1.95'+
					'c0,0.228,0.189,0.414,0.416,0.414h1.119C22.711,17.121,22.896,16.935,22.896,16.707z'+
					'M31.774,17.121c0.228,0,0.412-0.187,0.412-0.414v-1.95c0-0.229-0.185-0.415-0.412-0.415H30.65'+
					'c-0.229,0-0.415,0.186-0.415,0.415v1.95c0,0.228,0.186,0.414,0.415,0.414H31.774z'+
					'M4.649,14.342H3.525c-0.23,0-0.416,0.186-0.416,0.415v1.95c0,0.229,0.186,0.414,0.416,0.414h1.124'+
					'c0.228,0,0.411-0.185,0.411-0.414v-1.95C5.061,14.527,4.877,14.342,4.649,14.342z');
				// switch between text
				switch(match[2]) {
					case 'mp4':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 7 33)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 13)
							.text('mp4');
						return div;
					case 'x-flv':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 7.7 34)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('Flash');
						return div;
					case 'webm':
						em
							.append('text')
							.attr('transform', 'matrix(1 0 0 1 3.2 31)')
							.style('fill', '#c3c3c3')
							.attr('font-family', 'ITCAvantGardeStd-Bk')
							.attr('font-size', 12)
							.text('webm');
						return div;
				}
			}
		}
		return mimeIcon;
	}
]);