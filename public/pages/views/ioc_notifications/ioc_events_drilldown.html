<section head></section>
<div data-ng-controller="iocEventsDrilldownController">
    <section id="loading-error" loading-error></section>
    <section id="loading-spinner" loading-spinner></section>
    <script type="text/ng-template" id="tableModal.html">
      <div class="modal-header">
        <h3>{{data.class.toUpperCase()}}</h3>
      </div>
        <div class="modal-body">
            <div id="mTable"></div>
        </div>
      <div class="modal-footer">
        <button class="btn btn-primary" ng-click="ok()">Close</button>
      </div>
    </script>
    <script type="text/ng-template" id="descModal.html">
        <div class="modal-header">
            <h3>{{iocc}}</h3>
        </div>
        <div class="modal-body" id="descModalID" ng-bind-html-unsafe="{{data}}">{{data}}</div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">Close</button>
        </div>
    </script>
    <script type="text/ng-template" id="quarModal.html">
        <div class="modal-header">
            <h3>Are you sure you want to Quarantine?</h3>
        </div>
        <div class="modal-body" id="quarModalID">
            {{data}} <br /><br />
            <button type="button" class="button-success pure-button" ng-click="quarantineLink()">Yes</button>  <button type="button" class="button-error pure-button" ng-click="ok()">No</button>
        </div>
    </script>  
    <script type="text/ng-template" id="firewallModal.html">
        <div class="modal-header">
            <h3>Add Firewall Rule?</h3>
        </div>
        <div class="modal-body" id="firewallModalID">
            {{data}} <br /><br />
            <form id="myform" >
                <select id="fwSelect" name="fwSelect" ng-model="fiwa.select" ng-init="fiwa.select='ipaddress'" >
                  <option value="ipaddress" selected>IP Address</option>
                  <option value="ipsubnet">IP Subnet</option>
                  <option value="httpdomain">HTTP Domain</option>
                </select><br />
                <input type="text" id="fwTextarea" name="fwTextarea" ng-model="fiwa.text" placeholder="Type Rule Here"/><br />
                <button type="submit" class="button-success pure-button" ng-click="firewallLink(fiwa)">Add</button> 
                <button type="reset" class="button-error pure-button" ng-click="ok()">Cancel</button>
            </form>
        </div>
    </script>  
    <section severity-levels></section>
    <div class="row-fluid">
        <div class="span12">
            <!-- <div class="jdash-header">Link IOC Information</div> -->
            <div style="background-color:#FFF;" class="box">
                <!-- <div class="box-content"  style="min-height:195px !important"> -->
                <div class="box-content">

                    <div class="span3" style="border-right:1px solid #ccc; margin-bottom:10px;">
                        <h4 style="margin-top:-5px">Local IP</h4>
                        <div class="row-fluid">
                            <div class="span6">
                                <div class="row-fluid">
                                    <strong style="float:left" >Country: </strong><div style="float:left; margin-top:-8px;padding-left:10px;" class="f32"><span class="flag {{zone_cc}}"></span></div><span style="float:left"></span>
                                </div>
                                {{zone_country}}<br /> 
                                <strong>Zone: </strong>{{infoData.lan_zone}}<br />
                                <strong>Local IP: </strong>{{lan_ip}}<br />
                                <a href="#!/endpoint_map?lan_ip={{lan_ip}}&lan_zone={{lan_zone}}&type=flooruser&typeinfo=userinfoload" class="epmap">Endpoint Map</a>
                            </div>
                            <div class="span6">
                                <img class="logo" width="48" ng-src="{{userImage || 'public/system/assets/img/userplaceholder.jpg'}}" alt=""/><br />
                                <strong>Machine name:<br /> </strong>{{infoData.machine}}<br />
                                <strong>Custom name: </strong>{{infoData.custom_user || "-"}}
                            </div>
                        </div>
                    </div>
                    <div class="span4" style="border-right:1px solid #ccc; margin-bottom:10px;">
                        <h4 style="margin-top:-5px">Remote IP</h4>
                        <div class="row-fluid">
                            <div class="span6">
                                <div class="row-fluid">
                                    <strong style="float:left" >Country: </strong><div style="float:left; margin-top:-8px;padding-left:10px;" class="f32"><span class="flag {{infoData.remote_cc.toLowerCase()}}"></span></div><span style="float:left"></span>
                                </div>
                                {{infoData.remote_country}}<br />
                                <strong>Remote IP: </strong>{{remote_ip}}<br />
                                <strong>Remote ASN Name: </strong>{{infoData.remote_asn_name}}<br />
                            </div>
                            <div class="span6">
                                <strong>First IOC Hit: </strong>{{first}}<br />
                                <strong>Last IOC Hit: </strong>{{last}}<br />
                            </div>
                        </div>
                    </div>

                    <div class="span3" style="border-right:1px solid #ccc; margin-bottom:10px; padding-right: 10px;">
                        <h4 style="margin-top:-5px">IOC Information</h4>
                        <div class="row-fluid">
                            <strong>IOC: </strong>{{infoData.iocc}}<br />
                            <strong>IOC Type: </strong>{{infoData.ioc_typeIndicator}}<br />
                            <strong>IOC Info: </strong>{{infoData.desc}}<span ioc-desc></span><br />
                            <a href="" ng-click="getChildIOC()" class="epmap">Show all Attributes</a>
                            <!-- <strong>IOC Rule: </strong>{{ioc_rule}}<span ioc-desc><br /> -->
                        </div>
                    </div>    
                    <div class="span2">
                        <h4 style="margin-top:-5px">Actions</h4>
                        <div class="row-fluid">
                            <div>
                                <button type="button" class="action-bttns {{user_quar ? 'red' : 'blue' }}" ng-click="quarLoad()">
                                    <svg class="action-icon ">
                                        <defs>
                                            <path xmlns="http://www.w3.org/2000/svg" d="M36.6,32.1c1.4-2.2,2.4-4.7,2.9-7.3c-8.1-3.3-13.8-11.2-13.8-20.5c0-1.1,0.1-2.1,0.2-3.1 C23.7,0.4,21.3,0,18.8,0c-0.2,0-0.4,0-0.6,0c-0.2,1.4-0.3,2.9-0.3,4.3C17.9,16.9,25.6,27.7,36.6,32.1z M94.3,36.2c-4.3,5-10.6,8.1-17.7,8.1c-12.9,0-23.4-10.4-23.4-23.3c0-3.8,0.9-7.5,2.6-10.7l-2.8-1.6 c-1.2,1.4-3.1,2.4-5.1,2.4c-2.1,0-3.9-0.9-5.1-2.4l-3,1.8c1.6,3.2,2.5,6.8,2.5,10.6c0,12.9-10.5,23.3-23.4,23.3 c-7,0-13.3-3.1-17.6-7.9L0,37.1c6.2,8,15.9,13.1,26.7,13.1c8,0,15.3-2.8,21.1-7.4c5.8,4.6,13.1,7.4,21.1,7.4 c10.9,0,20.6-5.2,26.7-13.1L94.3,36.2z" id="p" transform="scale(.3,.3) translate(10,60)"/></path>
                                        </defs>
                                        <use xmlns="http://www.w3.org/2000/svg" xlink:href="#p"/>
                                        <use xmlns="http://www.w3.org/2000/svg" xlink:href="#p" transform="rotate(120, 17.5, 19)"/>
                                        <use xmlns="http://www.w3.org/2000/svg" xlink:href="#p" transform="rotate(240, 17.5, 19)"/>
                                    </svg>
                                </button>
                                <div class="action-text {{user_quar ? 'red' : 'blue' }}"><span>Stealth Quarantine</span></div>
                
                            </div>
                            <hr style="margin: 8px 0px 8px 0px"></hr>
                            <div>
                                <button type="button" class="action-bttns red" ng-click="firewallLoad()">
                                    <svg class="action-icon">
                                    <path d="M77.2,15.2h26.5c1.8,0,3.2-1.4,3.2-3.2V3.2c0-1.8-1.4-3.2-3.2-3.2H77.2C75.5,0,74,1.4,74,3.2V12
                                        C74,13.8,75.5,15.2,77.2,15.2z M40.8,15.2h26.5c1.8,0,3.2-1.4,3.2-3.2V3.2c0-1.8-1.4-3.2-3.2-3.2H40.8c-1.8,0-3.2,1.4-3.2,3.2V12 C37.7,13.8,39.1,15.2,40.8,15.2z M84.2,18.1H57.7c-1.8,0-3.2,1.4-3.2,3.2v8.9c0,1.8,1.4,3.2,3.2,3.2h26.5c1.8,0,3.2-1.4,3.2-3.2v-8.9 C87.3,19.5,85.9,18.1,84.2,18.1z M74.3,39.7v8.9c0,1.8,1.4,3.2,3.2,3.2h26.5c1.8,0,3.2-1.4,3.2-3.2v-8.9c0-1.8-1.4-3.2-3.2-3.2H77.5 C75.7,36.5,74.3,37.9,74.3,39.7z M84,54.9H57.5c-1.8,0-3.2,1.4-3.2,3.2V67c0,1.8,1.4,3.2,3.2,3.2H84c1.8,0,3.2-1.4,3.2-3.2v-8.9 C87.2,56.3,85.7,54.9,84,54.9z M104.2,54.9H93.6c-1.8,0-3.2,1.4-3.2,3.2V67c0,1.8,1.4,3.2,3.2,3.2h10.6c1.8,0,3.2-1.4,3.2-3.2v-8.9 C107.4,56.3,106,54.9,104.2,54.9z M104.2,18.1H93.6c-1.8,0-3.2,1.4-3.2,3.2v8.9c0,1.8,1.4,3.2,3.2,3.2h10.6c1.8,0,3.2-1.4,3.2-3.2v-8.9 C107.4,19.5,106,18.1,104.2,18.1z M35.4,39c-0.2-0.4-0.5-0.9-0.9-1.3C27.7,30.6,20,18.6,28.8,3.5C12.8,14.8,16,28.9,23,41.6 c7,12.6-10.1,13.5-9.6,3.8c0.5-9.7,3.7-18.1-5.8-22.8C8,29.4,11.5,30,5.8,37.8c-0.2,0.3-0.3,0.5-0.5,0.8C2,42.1,0,46.9,0,52 c0,8,4.7,14.9,11.6,18.1c0-0.3-0.1-0.6-0.1-1c0-4.7,3.9-8.6,8.6-8.6c4.8,0,8.6,3.8,8.6,8.6c0,0.3,0,0.6-0.1,1 C35.6,66.9,40.3,60,40.3,52C40.3,47.1,38.5,42.5,35.4,39z M48.8,18.1h-19c0.6,5.1,3.3,10.1,8.1,15.2h10.9c1.8,0,3.2-1.4,3.2-3.2v-8.9 C52,19.5,50.6,18.1,48.8,18.1z M67.6,36.5H41.1c-0.3,0-0.6,0-0.9,0.1c3.2,4.3,5,9.5,5,14.9c0,0.1,0,0.1,0,0.2h22.4 c1.8,0,3.2-1.4,3.2-3.2v-8.9C70.7,37.9,69.3,36.5,67.6,36.5z M48.7,54.9h-3.8c-0.8,5.9-3.8,11.3-8.2,15.2h12c1.8,0,3.2-1.4,3.2-3.2v-8.9 C51.9,56.3,50.4,54.9,48.7,54.9z" transform="scale(.3,.3) translate(0,24)"/ >
                                    </svg>
                                </button>
                                <div class="action-text red">Add Firewall Rule</span></div>
                            </div> 
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="row-fluid">
        <div class="span8">
            <div class="row-fluid">
                <div id="box">
                    <div class="box-content">
                        <div id="lanegraph" lane-graph></div>
                        <!-- <div id="lanegraph-pattern" lane-graph-pattern></div> -->
                    </div>
                </div>
            </div>          
        </div>
        <div class="span4">
            <div id="box">
                <div class="box-content">
                    <div class="lanegraphtitle"><strong>Event Info</strong> <form action="" id="autoExpand"><input type="checkbox" id="autoexpand" name="autoexpand" value="autoexpand" checked=""> Auto Expand</form></div>
                    <div id="lanegraphinfo"></div>
                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="row-fluid">
        <div class="span6">
            <div class="jdash-header">Connections to Remote Servers (# Connections) Involving IOCs</div>
            <div  style="background-color:#FFF;" class="box">
                <div class="box-content">
                    <div id="forcechart" make-force-chart></div>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="jdash-header">IOC Threat Chain (Local System IP, IOC Category, IOC Child ID, IOC Attribute Type)</div>
            <div  style="background-color:#FFF;" class="box">
                <div class="box-content">
                    <div id="treechart" make-tree-chart></div>
                </div>
            </div>
        </div>
    </div>
    <br />

</div>